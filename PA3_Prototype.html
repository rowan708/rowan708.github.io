<script src="https://apis.google.com/js/api.js"></script>
<script src="scripts.js"></script>

<center>
<label for="site-search"><font size='7'> Learn AllAbout<br></font></label>
<input type="search" id="site-search" name="q"
       aria-label="Search through site content">

<button onclick="getnewInfo()">Search</button>
	
	<a href="index.html" target="">
	<input type="button" value="Home"></a>
<br><br>
	<script>
	getNewInfo();	
	</script>

<head>
        <title>AllAbout Results</title>
        <meta name="viewport" content="initial-scale=1.0">
        <meta charset="utf-8">
        <style>          
          #map { 
            height: 300px;    
            width: 600px;            
          }    
        body {
		background-color: #98FB98;
        }      
        </style> 
	<br>
	       
    </head>    
    <body>
		
        <div hidden="true" id="latclicked"></div>
        <div hidden="true" id="longclicked"></div>
        
        <div id="latmoved"></div>
        <div id="longmoved"></div>
        
        <div style="padding:10px">
        <div id="map"></div>
        </div>
        
<!-- -----------------------------------------------MAP SECTION------------------------ -->

        <script type="text/javascript">
        var map;
        
	function clearMarkers() {
	   for (var i = 0; i < markers.lenght; i++) {
              markers[i].setMap(null);
           }
 	}

        function initMap() {    
		var latitude;
		var longitude;                            
		if (typeof localStorage.getItem("latitude") !== 'undefined') {
    		    latitude = parseFloat(localStorage.getItem("latitude"));
		}
		else {
		    latitude = 29.77841935207528; // YOUR LATITUDE VALUE
		}
		if (typeof localStorage.getItem("longitude") !== 'undefined') {
 	 	    longitude = parseFloat(localStorage.getItem("longitude"));
		}	
		else {
		    longitude = -95.44739050812211; // YOUR LONGITUDE VALUE
		}
            
            
            var myLatLng = {lat: latitude, lng: longitude};
            
            map = new google.maps.Map(document.getElementById('map'), {
              center: myLatLng,
              zoom: 9,
              disableDoubleClickZoom: true, // disable the default map zoom on double click
            });
            
            // Update lat/long value of div when anywhere in the map is clicked    
            google.maps.event.addListener(map,'click',function(event) {                
                document.getElementById('latclicked').innerHTML = event.latLng.lat();
                document.getElementById('longclicked').innerHTML =  event.latLng.lng();
		localStorage.setItem("latitude", event.latLng.lat());
		localStorage.setItem("longitude", event.latLng.lng());
		window.location.reload();
            });
                    
            var marker = new google.maps.Marker({
              position: myLatLng,
              map: map,
              //title: 'Hello World'            
              // setting latitude & longitude as title of the marker
              // title is shown when you hover over the marker
              title: latitude + ', ' + longitude 
            });    
            
            // Update lat/long value of div when the marker is clicked
            marker.addListener('click', function(event) {              
              document.getElementById('latclicked').innerHTML = event.latLng.lat();
              document.getElementById('longclicked').innerHTML =  event.latLng.lng();
	      localStorage.setItem("latitude", event.latLng.lat());
	      localStorage.setItem("longitude", event.latLng.lng());
	      window.location.reload();
            });
            
            // Create new marker on double click event on the map
            google.maps.event.addListener(map,'dblclick',function(event) {
                
				var marker = new google.maps.Marker({
                  position: event.latLng, 
                  map: map, 
                  title: event.latLng.lat()+', '+event.latLng.lng()
                });
                
                // Update lat/long value of div when the marker is clicked
                marker.addListener('click', function() {
                  document.getElementById('latclicked').innerHTML = event.latLng.lat();
                  document.getElementById('longclicked').innerHTML =  event.latLng.lng();
                });  
								
            });
            
            // Create new marker on single click event on the map 
            google.maps.event.addListener(map,'click',function(event) {
                var marker = new google.maps.Marker({
                  position: event.latLng, 
                  map: map, 
                  title: event.latLng.lat()+', '+event.latLng.lng()
                });                
            }); 
        }
        </script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCnwERZ45OQ0g5O6yWkcfke3JsOZAw2AmY&callback=initMap"
        async defer></script>
</body>    

<!-- -----------------------------------------------WEATHER SECTION------------------------ -->

<script>
   document.write("<br>***Information is currently returned to the developer console*** <br>");
   window.onload = function() {
     const aeris = new AerisWeather('6uIQRVK5f7M2gNt9bFckZ', '8iMYYFJt0YRZSRGdlpMX8dkpDqPX1U4wATKnkBkf');
     var latlong = String(localStorage.getItem("latitude")) + ', ' + String(localStorage.getItem("longitude"));
     var request = aeris.api().endpoint('forecasts').place(latlong).format('json').filter('day').limit('7');
     request.get().then((result) => {
        console.log(result);
	localStorage.setItem("day1temp", result.data[0].periods[0].avgTempF);
	localStorage.setItem("day2temp", result.data[0].periods[1].avgTempF);
	localStorage.setItem("day3temp", result.data[0].periods[2].avgTempF);
	localStorage.setItem("day4temp", result.data[0].periods[3].avgTempF);
	localStorage.setItem("day5temp", result.data[0].periods[4].avgTempF);
	localStorage.setItem("day6temp", result.data[0].periods[5].avgTempF);
	localStorage.setItem("day7temp", result.data[0].periods[6].avgTempF);
     });    
   };	
</script>
<br>

<!-- -----------------------------------------------WEATHER DISPLAY SECTION------------------------ -->

<script src="https://cdn.aerisapi.com/sdk/js/latest/aerisweather.min.js"></script>
<div id="target"></div>
<br>
<br>
<body>
	<font size="5"> FORECAST </font>
	
	<script>
		function myDate(numDaysPastToday) {
			var today = new Date(new Date().getTime() + 24*60*60*1000*numDaysPastToday);
			var year = today.getFullYear();
			var month = today.getMonth() + 1;
			var day = today.getDate();
			return (month + "/" + day);
			
		}
	</script>
	<style>
	table, th {
		border: 1px solid black;
	}
	th, td {
		padding: 10px;
	}
	</style>
		
		
	<table width="750" style="background-color: #FFFFFF">

	<tr>
		<th> </th>
		<th><script>
			document.write(myDate(0));
		</script></th> 
		<th> <script> 
			document.write(myDate(1));
		</script> </th> 
		<th><script>
			document.write(myDate(2));
		</script></th> 
		<th> <script> 
			document.write(myDate(3));
		</script> </th> 
		<th><script>
			document.write(myDate(4));
		</script></th> 
		<th> <script> 
			document.write(myDate(5));
		</script> </th> 
		<th><script>
			document.write(myDate(6));
		</script></th> 
	</tr>
	<tr>
		<td> <center>Gphx</center> </td>
		<td> <center> <div><img id="weatherimg0"/> </div>
		<script> 
		var imgCtrl = "asdfg"
		if( imgCtrl == "cloudy"){
			document.getElementById("weatherimg0").src = "cloudy.png";
		}
		else if ( imgCtrl == "sunny") {
			document.getElementById("weatherimg0").src = "sunny.png";
		}
		else if ( imgCtrl == "rainy") {
			document.getElementById("weatherimg0").src = "rainy.png";		
		}
		else if ( imgCtrl == "snowy") {
			document.getElementById("weatherimg0").src = "snowy.png";
		}
		else {
			document.getElementById("weatherimg0").src = "sunny.png";
		}
		</script> </center> </td>
		<td> <center> 
		<script> 
		
		</script> </center> </td>
		<td> <center> <script> 
		
		</script> </center> </td>
		<td> <center>
		<script> 
		
		</script> </center> </td>
		<td> <center> 
		<script> 
		
		</script> </center> </td>
		<td> <center> 
		<script> 
		
		</script> </center> </td>
		<td> <center> 
		<script> 
		
		</script> </center> </td>

	</tr>
	<tr>
		<td> <center>Temp</center> </td>
		<td> <center> <script> localStorage.getItem("day1temp") </script> </center> </td>
		<td> <center> <script> localStorage.getItem("day2temp") </script> </center> </td>
		<td> <center> <script> localStorage.getItem("day3temp") </script> </center> </td>
		<td> <center> <script> localStorage.getItem("day4temp") </script> </center> </td>
		<td> <center> <script> localStorage.getItem("day5temp") </script> </center> </td>
		<td> <center> <script> localStorage.getItem("day6temp") </script> </center> </td>
		<td> <center> <script> localStorage.getItem("day7temp") </script> </center> </td>
	</tr>
	<tr>
		<td> <center>Precip</center> </td>
		<td> <center> 20% Rain </center> </td>
		<td> <center> 20% Snow </center> </td>
		<td> <center> 20% Sleet </center> </td>
		<td> <center> 20% Sun </center> </td>
		<td> <center> 20% Cloud </center> </td>
		<td> <center> 20% Rain </center> </td>
		<td> <center> 20% Rain </center> </td>
	</tr>

	</table>
	<script>
    //<img src="PA3_images/weather.jpg" alt="Weather Forecast" width="800" height="320">
    </script>
</body>

<!-- -----------------------------------------------TOURIST SECTION------------------------ -->

<script>
document.write("<br><font size='5'>POPULAR PLACES</font><br>");
const yelp = require('yelp-fusion');

// Place holder for Yelp Fusion's API Key. Grab them
// from https://www.yelp.com/developers/v3/manage_app
const apiKey = 'haVaFxg5M-FL-bJkMwuJRd_3xeovGAtDLrPtLyzX2_PcsR_0a3VgDF9yyn5KFYSvK3mHeYJyDGg7ym5fj9d_mxxiSCdndG1KM36c87hTCpbeajqgPUgFmeceYxvOXHYx';

const searchRequest = {
  latitude: parseFloat(localStorage.getItem("latitude")),
  longitude: parseFloat(localStorage.getItem("longitude"))
};

const client = yelp.client(apiKey);

client.search(searchRequest).then(response => {
  const firstResult = response.jsonBody.businesses[0];
  const prettyJson = JSON.stringify(firstResult, null, 4);
  console.log(prettyJson);
}).catch(e => {
  console.log(e);
});
</script>

<body>
   <img src="tourist_houston.png" alt="Tourist Stuff" width="800" height="320">
</body>	

<!-- -----------------------------------------------YOUTUBE SECTION------------------------ -->

<script>
  document.write("<br><br><font size='5'> POPULAR VIDEOS</font><br>");
  //loadClient();
  //execute();
  /**
   * Sample JavaScript code for youtube.search.list
   * See instructions for running APIs Explorer code samples locally:
   * https://developers.google.com/explorer-help/guides/code_samples#javascript
   */

  function loadClient() {
    gapi.client.setApiKey("AIzaSyCnwERZ45OQ0g5O6yWkcfke3JsOZAw2AmY");
    return gapi.client.load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest")
        .then(function() { console.log("GAPI client loaded for API"); },
              function(err) { console.error("Error loading GAPI client for API", err); });
  }
  // Make sure the client is loaded before calling this method.
  function execute(search) {
    return gapi.client.youtube.search.list({
      "part": "snippet",
      "maxResults": 25,
      "q": "test"
    })
        .then(function(response) {
                // Handle the results here (response.result has the parsed body).
                console.log("Response", response);
              },
              function(err) { console.error("Execute error", err); });
  }
  gapi.load("client");
</script>

<div id="player"></div>
<script>
      // 2. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          videoId: 'qV_CJbh_rD0',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      // 4. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        //event.target.playVideo();
      }

      // 5. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          setTimeout(stopVideo, 6000);
          done = true;
        }
      }
      function stopVideo() {
        player.stopVideo();
      }

    </script>
</center>

